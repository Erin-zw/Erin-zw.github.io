<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Erin枫</title>
    <link>http://example.com/</link>
    
    <atom:link href="http://example.com/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>来者犹可追</description>
    <pubDate>Thu, 11 May 2023 10:00:44 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>dicom基础知识补充</title>
      <link>http://example.com/2023/06/18/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E9%97%AE%E9%A2%98/</link>
      <guid>http://example.com/2023/06/18/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E9%97%AE%E9%A2%98/</guid>
      <pubDate>Sun, 18 Jun 2023 12:54:36 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;传输语法&quot;&gt;&lt;a href=&quot;#传输语法&quot; class=&quot;headerlink&quot; title=&quot;传输语法&quot;&gt;&lt;/a&gt;传输语法&lt;/h2&gt;&lt;p&gt;在DICOM（数字成像和通信医学）中，传输语法描述了DICOM文件中像素数据和其他元数据的编码方式和格式。传输语法还定义了D</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="传输语法"><a href="#传输语法" class="headerlink" title="传输语法"></a>传输语法</h2><p>在DICOM（数字成像和通信医学）中，传输语法描述了DICOM文件中像素数据和其他元数据的编码方式和格式。传输语法还定义了DICOM文件的字节顺序、VR（值表示）类型和其他元数据的编码方式。</p><p>传输语法可以是封装的或未封装的。封装的传输语法通常用于压缩像素数据，以减小DICOM文件的大小。因此，当检查DICOM文件的传输语法时，可以确定它是否包含压缩的像素数据。如果传输语法是封装的，那么解码图像数据时需要先进行解封装（解压缩），然后再将其转换为图像。</p><h2 id="ExplicitVRLittleEndian"><a href="#ExplicitVRLittleEndian" class="headerlink" title="ExplicitVRLittleEndian"></a>ExplicitVRLittleEndian</h2><p>ExplicitVRLittleEndian是DICOM文件的一种传输语法，也称为明示VR（值表示）小端字节序。这种传输语法被广泛用于DICOM文件中，它指定了数据元素的VR类型和字节序。在ExplicitVRLittleEndian传输语法中，每个数据元素都由一个16位的标签和一个16位的VR值组成。如果数据元素的VR类型是数字、日期或时间等固定长度的值，则接下来的字节是该值的字节表示。如果数据元素的VR类型是可变长度的字符串或字节数组，则VR值指示了该值的长度，并在之后的字节中存储该值的内容。ExplicitVRLittleEndian传输语法使用小端字节序，即最低有效字节在最前面的方式来存储数据。因此，在读取DICOM文件时，需要按照这种顺序来解析数据元素的值。</p><h2 id="DicomJpegLsParams"><a href="#DicomJpegLsParams" class="headerlink" title="DicomJpegLsParams"></a>DicomJpegLsParams</h2><p>DicomJpegLsParams是一个用于指定JPEG-LS压缩算法参数的类。在DICOM中，JPEG-LS是一种无损压缩算法，通常用于减小DICOM文件中像素数据的大小。DicomJpegLsParams类中包含了一些属性，用于指定JPEG-LS压缩算法的参数，例如压缩比例、预测算法、重构算法等。当使用DICOM库进行图像解码时，可以将DicomJpegLsParams参数传递给相关方法，以指定要使用的JPEG-LS压缩算法参数，从而更好地控制图像解码的过程。</p><h2 id="DicomImage和DicomFile类区别"><a href="#DicomImage和DicomFile类区别" class="headerlink" title="DicomImage和DicomFile类区别"></a>DicomImage和DicomFile类区别</h2><p>在DICOM（数字成像和通信医学）中，DicomImage和DicomFile都是用于表示DICOM图像和文件的类，它们之间的区别如下：</p><ol><li>DicomImage表示DICOM图像数据，而DicomFile表示DICOM文件的数据和元数据。</li><li>DicomImage是一个特定的图像类，它提供了一些用于访问和处理DICOM图像数据的方法和属性，例如获取像素数据、获取像素点的值、调整图像亮度和对比度等。而DicomFile是一个通用的文件类，它提供了一些用于访问和处理DICOM文件的方法和属性，例如获取文件元数据、获取文件中的数据元素、读取和写入DICOM文件等。</li><li>DicomImage对象通常是从DicomFile对象中读取DICOM文件的像素数据得到的，可以通过将DicomFile对象传递给相关方法来创建DicomImage对象。因此，DicomFile对象是创建DicomImage对象的重要输入之一。</li><li><strong>DicomFile对象可以包含一个或多个DICOM图像数据，每个图像数据可以使用不同的传输语法和编码方式。而DicomImage对象仅表示单个DICOM图像数据，通常使用一种特定的传输语法和编码方式。</strong></li><li>在处理DICOM文件时，通常需要首先创建一个DicomFile对象，然后从中提取需要的图像数据，然后使用DicomImage对象对图像数据进行处理和显示。</li></ol><h2 id="Dicom图像帧数以及选取"><a href="#Dicom图像帧数以及选取" class="headerlink" title="Dicom图像帧数以及选取"></a>Dicom图像帧数以及选取</h2><p>在DICOM图像中，图像帧数指的是该图像中包含的图像帧（Image Frame）的数量。一个图像帧表示了图像在某个时间点的状态，可以理解为一个静止的图像。举个例子，一个磁共振成像（MRI）的DICOM图像可能包含多个图像帧，每个图像帧表示了扫描仪在不同的时间点捕获的MRI图像。</p><p>在处理DICOM图像时，需要根据图像帧数的数量来确定需要处理的图像帧，以及如何将多个图像帧组合成完整的图像。例如，对于一张包含多个图像帧的DICOM图像，我们可以选择只处理其中的某一个图像帧，或者将所有图像帧合并成一个三维的立体图像。因此，在处理DICOM图像时，图像帧数是一个非常重要的参数。</p><p>在DICOM图像中，像素数据是存储图像信息的最重要的数据元素之一。每个像素的值代表了图像中一个点的亮度或灰度。在多帧DICOM图像中，每一帧都包含了一组像素数据，用来表示该帧对应的图像。因此，一个多帧DICOM图像中的所有帧的像素数据总和就是整个图像的像素数据。并且帧数是从0开始计数的，即第一帧的帧数为0，第二帧的帧数为1，以此类推。这与一些其他编程语言或者图像处理库中可能采用的从1开始计数的方式略有不同，需要注意。在使用DICOM相关的编程库或者工具时，应该遵循DICOM标准，以保证正确解析和处理DICOM图像数据。</p><p>在代码中，如果一个DICOM图像只有一帧，那么只需要获取这一帧的像素数据即可，因为它就是整个图像的像素数据。而如果一个DICOM图像有多帧，为了简化处理过程，代码中选择只获取第1帧的像素数据，而不是获取所有帧的像素数据并将它们组合起来。这是因为第1帧通常包含了完整的图像信息，而<strong>其他帧则可能只包含了该图像的某些局部信息或补充信息</strong>。同时，获取第1帧的像素数据可以让代码更加简洁和高效，因为不需要处理多个像素数据数组。当然，如果需要获取其他帧的像素数据，也可以在代码中进行相应的修改。</p><h2 id="按列存储"><a href="#按列存储" class="headerlink" title="按列存储"></a>按列存储</h2><p>dicom图像的像素信息是按照列主序存储的。在此次设计例子中，<code>values</code>数组中前<code>height</code>个元素存储的是第一列像素的值，接下来的<code>height</code>个元素存储的是第二列像素的值，以此类推，直到最后一列。因此，在将<code>values</code>数组转换为<code>Bitmap</code>对象时，需要按照列进行遍历并设置像素的值。</p><h2 id="SOP和服务类的区别"><a href="#SOP和服务类的区别" class="headerlink" title="SOP和服务类的区别"></a>SOP和服务类的区别</h2><p>SOP和服务类是DICOM中的两个概念，它们有相似之处，但又有一些区别。</p><p>SOP（Service-Object Pair）是指DICOM中的服务和对象对，即一个服务与一个对象之间的关系。SOP包含两个方面：服务（Service）和对象（Object），表示在DICOM中，一个服务可以针对一个特定的对象进行操作。每个SOP的实例都有一个唯一的UID标识符。</p><p>服务类（Service Class）是针对某种功能而定义的服务的集合，它是一组相关的SOP类的总称。服务类包括一组操作，这些操作的目的是在不同设备之间传输图像和相关信息。每个服务类都有一个唯一的UID标识符。</p><p>两者的区别在于，SOP是服务和对象之间的关系，是具体的实例，而服务类是一组相关的SOP类的总称，是具有相同功能的一组服务的集合。SOP相当于一个文件的名称，服务类则相当于一组文件的集合。    </p>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</category>
      
      
      
      <comments>http://example.com/2023/06/18/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E9%97%AE%E9%A2%98/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>dicom图像操作代码分析</title>
      <link>http://example.com/2023/06/18/Csharp/%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/</link>
      <guid>http://example.com/2023/06/18/Csharp/%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/</guid>
      <pubDate>Sun, 18 Jun 2023 12:54:36 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;移动操作&quot;&gt;&lt;a href=&quot;#移动操作&quot; class=&quot;headerlink&quot; title=&quot;移动操作&quot;&gt;&lt;/a&gt;移动操作&lt;/h2&gt;&lt;p&gt;对dicom图像进行移动操作&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="移动操作"><a href="#移动操作" class="headerlink" title="移动操作"></a>移动操作</h2><p>对dicom图像进行移动操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">// 定义一个指针类型变量，用于记录鼠标在图像上的初始位置</span><br><span class="line">      private Point _startPoint;</span><br><span class="line"></span><br><span class="line">      // 定义一个变量，用于记录图像当前的位置</span><br><span class="line">      private Point _imageLocation;</span><br><span class="line"></span><br><span class="line">      private void pictureBox1_MouseDown(object sender, MouseEventArgs e)//鼠标左击事件发生</span><br><span class="line">      &#123;</span><br><span class="line">          if (e.Button == MouseButtons.Left)</span><br><span class="line">          &#123;</span><br><span class="line">              _startPoint = e.Location;//记录鼠标按下时的位置，也即图像的起始位置</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      private void pictureBox1_MouseMove(object sender, MouseEventArgs e)//光标拖动事件发生</span><br><span class="line">      &#123;</span><br><span class="line">          if (e.Button == MouseButtons.Left &amp;&amp; _startPoint != null)//如果鼠标左键任然按下进行以下操作</span><br><span class="line">          &#123;</span><br><span class="line">              int x = _imageLocation.X + (e.Location.X - _startPoint.X);//定义新位置的x坐标</span><br><span class="line">              int y = _imageLocation.Y + (e.Location.Y - _startPoint.Y);//y坐标</span><br><span class="line"></span><br><span class="line">              // 将图像移动到新的位置</span><br><span class="line">              pictureBox1.Location = new Point(x, y);//使用Location方法移动图像至新的位置</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      private void pictureBox1_MouseUp(object sender, MouseEventArgs e)//鼠标抬起事件</span><br><span class="line">      &#123;</span><br><span class="line">          if (e.Button == MouseButtons.Left)</span><br><span class="line">          &#123;</span><br><span class="line">              _imageLocation = pictureBox1.Location;//将图像在鼠标抬起后的位置赋值给变量，方便进行下一次的移动操作</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="放大缩小操作"><a href="#放大缩小操作" class="headerlink" title="放大缩小操作"></a>放大缩小操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">float zoomFactor = 1.0f;//缩放因子，初始值为1</span><br><span class="line"></span><br><span class="line">private void button1_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    // 增加放大比例，并更新pictureBox1控件大小和SizeMode</span><br><span class="line">    zoomFactor += 0.1f;</span><br><span class="line">    pictureBox1.Size = new Size((int)(pictureBox1.Image.Width * zoomFactor), (int)(pictureBox1.Image.Height * zoomFactor));</span><br><span class="line">    pictureBox1.SizeMode = PictureBoxSizeMode.Zoom;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void button2_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    // 减小放大比例，并更新控件大小和SizeMode</span><br><span class="line">    zoomFactor -= 0.1f;</span><br><span class="line">    pictureBox1.Size = new Size((int)(pictureBox1.Image.Width * zoomFactor), (int)(pictureBox1.Image.Height * zoomFactor));</span><br><span class="line">    pictureBox1.SizeMode = PictureBoxSizeMode.Zoom;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="旋转操作"><a href="#旋转操作" class="headerlink" title="旋转操作"></a>旋转操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">private void button3_Click(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">    // 获取目前控件中的Image对象赋值给一个新的Image类型变量</span><br><span class="line">    Image currentImage = pictureBox1.Image;</span><br><span class="line"></span><br><span class="line">    //使用自带的RotateFlip旋转翻转方法，使用参数RotateFlipType.Rotate90FlipNone实现旋转图像90°无翻转</span><br><span class="line">    currentImage.RotateFlip(RotateFlipType.Rotate90FlipNone);</span><br><span class="line"></span><br><span class="line">    // 将操作后的currentImage更新至控件图像</span><br><span class="line">    pictureBox1.Image = currentImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/C-%E5%AD%A6%E4%B9%A0/">C#学习</category>
      
      
      
      <comments>http://example.com/2023/06/18/Csharp/%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>dicom图像显示代码分析</title>
      <link>http://example.com/2023/06/18/Csharp/%E4%BA%8C/</link>
      <guid>http://example.com/2023/06/18/Csharp/%E4%BA%8C/</guid>
      <pubDate>Sun, 18 Jun 2023 12:54:36 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;由于先前并未学习使用过C#，本文采用&lt;strong&gt;Chatgpt&lt;/strong&gt;进行辅助分析。&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=</description>
        
      
      
      
      <content:encoded><![CDATA[<p>由于先前并未学习使用过C#，本文采用<strong>Chatgpt</strong>进行辅助分析。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.ComponentModel;</span><br><span class="line">using System.Data;</span><br><span class="line">using System.Drawing;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Windows.Forms;</span><br><span class="line">//using System.Drawing;</span><br><span class="line">using System.Drawing.Imaging;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.Runtime;</span><br><span class="line">using System.Runtime.Serialization;</span><br><span class="line">using System.Runtime.Serialization.Formatters;</span><br><span class="line">using System.Runtime.Serialization.Formatters.Binary;</span><br><span class="line">using Dicom;</span><br><span class="line">using Dicom.IO;</span><br><span class="line">using Dicom.IO.Buffer;</span><br><span class="line">using Dicom.Imaging;</span><br><span class="line">using Dicom.Imaging.Codec;</span><br><span class="line">using Dicom.Imaging.Codec.Jpeg;</span><br><span class="line">using System.Runtime.InteropServices;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">namespace DrawingDCMExample //定义总命名空间</span><br><span class="line">&#123;</span><br><span class="line">    public partial class DICOMProcessDemo : Form //这段代码定义了一个名为DICOMProcessDemo的类，该类继承自Form类，并被定义为public和partial。由于它被定义为partial，可以在其他文件中定义该类的其他部分。</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// The Image member that inserted in PictureBox</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        </span><br><span class="line">        private string defaultImageBG;//用于存放默认背景的路径</span><br><span class="line">        </span><br><span class="line">        public DICOMProcessDemo()//DICOMProcessDemo类的初始化</span><br><span class="line">        &#123;</span><br><span class="line">            InitializeComponent();</span><br><span class="line">            //这个方法的作用是初始化窗体中的控件，包括将控件添加到窗体中、设置控件的位置和大小、以及绑定事件处理程序等。</span><br><span class="line">            string appPath = Application.StartupPath;//定义appPath为程序启动路径</span><br><span class="line">            string imagePath = appPath + @&quot;\..\..\..\..\&quot; + @&quot;Resource\defaultbackgroundImage.bmp&quot;;</span><br><span class="line">            //具体地说，这个路径是通过将appPath（应用程序的路径）与一个相对路径拼接而成的。其中，@&quot;........&quot;表示向上跳四级目录，即到应用程序所在的根目录，然后再跳到Resource文件夹下，最后再拼接上文件名&quot;defaultbackgroundImage.bmp&quot;。</span><br><span class="line">            //换句话说，这个路径指向了应用程序根目录下的Resource文件夹中的一个名为&quot;defaultbackgroundImage.bmp&quot;的位图文件。</span><br><span class="line">            defaultImageBG = imagePath;</span><br><span class="line">            pictureBox1.Image = Image.FromFile(imagePath);</span><br><span class="line">            //PictureBox是一个Windows Forms控件，用于在用户界面中显示图像。Image属性是PictureBox控件中用于存储和显示图像的属性。通过将其设置为从文件加载的图像，可以更改PictureBox控件中显示的图像。</span><br><span class="line">//Image.FromFile方法是一个静态方法，它可以从文件加载图像并返回一个Image对象。将返回的Image对象赋给PictureBox控件的Image属性，从而更改控件中显示的图像。</span><br><span class="line">            DicomTranscoder.LoadCodecs(Application.StartupPath, &quot;Dicom.Native*.dll&quot;);</span><br><span class="line">            //这段代码DicomTranscoder.LoadCodecs(Application.StartupPath, &quot;Dicom.Native*.dll&quot;);是用于加载DICOM图像编解码器的代码。</span><br><span class="line">//在这里，DicomTranscoder是一个用于DICOM图像编解码的类。LoadCodecs是该类的一个静态方法，用于从指定目录中加载编解码器。Application.StartupPath是指当前应用程序的启动路径，而&quot;Dicom.Native*.dll&quot;则是指定要加载的编解码器的文件名模式。*通配符表示任何字符。通过加载编解码器，我们可以在应用程序中使用DICOM图像，并将其转换为其他格式，例如BMP或JPEG，以在屏幕上显示或进行分析。</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void openToolStripMenuItem_Click(object sender, EventArgs e)</span><br><span class="line">            //是一个事件处理方法，它是在用户单击菜单项 &quot;openToolStripMenuItem&quot; 时触发的。该方法的主要功能是打开一个文件对话框，允许用户选择一个文件，并将选择的文件加载到应用程序中。</span><br><span class="line">        &#123;</span><br><span class="line">            using(openFileDialog1 = new OpenFileDialog())</span><br><span class="line">                //这是 C# 中的一个 using 语句块，用于在代码块执行结束时自动释放资源。在这个例子中，using 语句块用于打开一个文件对话框，并在选择文件后自动关闭对话框并释放资源。</span><br><span class="line">            &#123;</span><br><span class="line">                openFileDialog1.Filter=&quot;DCM files(*.DCM)|*.DCM| dcm files(*.dcm)|*.dcm&quot;;</span><br><span class="line">                //这行代码是为 OpenFileDialog 对象设置一个过滤器，限制用户在打开文件对话框时只能选择特定类型的文件。</span><br><span class="line">//在这个例子中，Filter 属性的值为 &quot;DCM files(*.DCM)|*.DCM| dcm files(*.dcm)|*.dcm&quot;，表示可以选择后缀名为 .dcm 或 .DCM 的文件。该属性值的格式为 &quot;文件类型描述|文件扩展名&quot;，多个文件类型描述和文件扩展名之间用竖线 | 分隔，每个文件类型描述和文件扩展名之间用逗号 , 分隔。</span><br><span class="line">//因此，在这个例子中，文件类型描述分别为 &quot;DCM files&quot; 和 &quot;dcm files&quot;，文件扩展名分别为 &quot;*.DCM&quot; 和 &quot;*.dcm&quot;。用户在打开文件对话框时，只能选择这两种类型的文件，其他类型的文件会被过滤掉，不会显示在对话框中。在这里括号是进一步说明文件类型。</span><br><span class="line">                openFileDialog1.RestoreDirectory=true;</span><br><span class="line">//作用是在关闭文件对话框后，恢复到打开文件对话框前的目录。这样做的好处是避免了在用户打开文件对话框时意外地改变了当前目录，从而导致后续操作出现问题的情况。</span><br><span class="line">                if (openFileDialog1.ShowDialog() == DialogResult.OK)//检查用户是否在文件打开对话框中单击了确认按钮</span><br><span class="line">                &#123;</span><br><span class="line">                    string dcmPath = openFileDialog1.FileName.ToString();//dcm文件路径存储在 OpenFileDialog 类的 FileName 属性中。转换为字符串并存储在 dcmPath 变量中。</span><br><span class="line">                    //string dcmFileName = Path.Substring(Path.LastIndexOf(&quot;\\&quot;) + 1);</span><br><span class="line">                    listView1.Items.Clear();//清空 ListView 控件，以便准备向其中添加新项</span><br><span class="line">                    ShowAndDrawingDCMImage(dcmPath);//加载和显示 DICOM 文件中的图像。</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Show the metaInfo of the DCM file and Drawing the image on the Screen</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;dcmFileName&quot;&gt;The path of your DCM file&lt;/param&gt;</span><br><span class="line">        private void ShowAndDrawingDCMImage(string dcmFileName)//加载显示DICOM图像</span><br><span class="line">        &#123;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                DicomFile dcmFile = DicomFile.Open(dcmFileName);//执行此行代码后，将拥有一个DicomFile对象，该对象表示由dcmFileName参数指定的DICOM文件</span><br><span class="line">                LoadAndShowDCMMetaInfo(dcmFile);//加载和显示dicom文件的元数据信息</span><br><span class="line">                listView1.Update();//ListView控件刷新其显示并根据其基础数据源更新其内容</span><br><span class="line">                DrawingDCMData2Screen(dcmFile);//使用DICOM文件中的数据进行图像处理，并将其绘制到屏幕上，以便用户可以查看医学影像</span><br><span class="line">            &#125;</span><br><span class="line">            catch (System.Exception ex)</span><br><span class="line">            &#123;</span><br><span class="line">                MessageBox.Show(ex.Message);</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Load all of the Elements in the DCM Meta </span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;dcm&quot;&gt;the DICOM file&lt;/param&gt;</span><br><span class="line">        private void LoadAndShowDCMMetaInfo(DicomFile dcm)</span><br><span class="line">        &#123;</span><br><span class="line">            //Show the message of DCM file to the listview in the dialog.</span><br><span class="line">            DicomDataset dcmDataset = dcm.Dataset;//dcm对象数据集存储到变量</span><br><span class="line">            DicomFileMetaInformation dcmMetaInfo = dcm.FileMetaInfo;//dcm对象文件元信息存储到变量</span><br><span class="line">            listView1.BeginUpdate();</span><br><span class="line">            //控件的显示将暂时被挂起。在调用BeginUpdate()方法之后，通常会对控件中的项和子项进行更改，然后再调用EndUpdate()方法。这样可以确保控件的显示更新只会在所有更改完成后才执行，从而避免出现不必要的重绘操作。</span><br><span class="line">            //DICOM MetaInfo</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(dcmMetaInfo.MediaStorageSOPClassUID==null?&quot;&quot;:dcmMetaInfo.MediaStorageSOPClassUID.ToString()))//利用String.IsNullOrWhiteSpace方法，判断dcm文件中的SOP类的UID信息是否为空</span><br><span class="line">            &#123;</span><br><span class="line">                //Insert the ImplementationClassUID，</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0002&quot;);</span><br><span class="line">                //用group号“0002”创建ListViewItem对象赋值给newItem变量。也就是说，ListViewItem的构造函数被调用，传入了一个表示Tag Group Number为&quot;0002&quot;的字符串。这个字符串将被作为该ListViewItem的主显示文本（即第一列）</span><br><span class="line">                newItem.SubItems.Add(&quot;0002&quot;);</span><br><span class="line">                //在ListView控件中，每一行都可以有多个列（即子项），用来显示多个数据。因此，在创建ListViewItem对象之后，可以通过调用ListViewItem的SubItems属性，来获取该项的子项集合。通过调用Add方法，可以向该集合中添加新的子项。这里添加的子项是Tag Element number</span><br><span class="line">                newItem.SubItems.Add(dcmMetaInfo.MediaStorageSOPClassUID.ToString());</span><br><span class="line">                //第三列添加SOP类UID信息</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">                //将包含DICOM文件Tag Group Number、Tag Element Number和SOP类UID信息的newItem对象添加到了listView1控件的行集合中，使其显示在控件中。</span><br><span class="line">            &#125;</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(dcmMetaInfo.MediaStorageSOPInstanceUID==null?&quot;&quot;:dcmMetaInfo.MediaStorageSOPInstanceUID.ToString()))</span><br><span class="line">            &#123;</span><br><span class="line">                //Insert the ImplementationClassUID</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0002&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0003&quot;);</span><br><span class="line">                newItem.SubItems.Add(dcmMetaInfo.MediaStorageSOPInstanceUID.ToString());</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line"></span><br><span class="line">            &#125;//添加SOP实例UID信息</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(dcmMetaInfo.TransferSyntax==null?&quot;&quot;:dcmMetaInfo.TransferSyntax.ToString()))</span><br><span class="line">            &#123;</span><br><span class="line">                //Insert the ImplementationClassUID</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0002&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(dcmMetaInfo.TransferSyntax.ToString());</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line"></span><br><span class="line">            &#125;//添加传输语法UID信息</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(dcmMetaInfo.ImplementationClassUID==null?&quot;&quot;:dcmMetaInfo.ImplementationClassUID.ToString()))</span><br><span class="line">            &#123;</span><br><span class="line">                //Insert the ImplementationClassUID</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0002&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0012&quot;);</span><br><span class="line">                newItem.SubItems.Add(dcmMetaInfo.ImplementationClassUID.ToString());</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line"></span><br><span class="line">            &#125;//添加实现类UID信息，实现类 UID（Implementation Class UID）是DICOM中的一个标识符，用于表示医学图像设备或软件的厂商和型号信息。</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(dcmMetaInfo.ImplementationVersionName==null?&quot;&quot;:dcmMetaInfo.ImplementationVersionName.ToString()))</span><br><span class="line">            &#123;</span><br><span class="line">                //Insert the ImplementationClassUID</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0002&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0013&quot;);</span><br><span class="line">                newItem.SubItems.Add(dcmMetaInfo.ImplementationVersionName.ToString());</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line"></span><br><span class="line">            &#125;//添加版本号信息。DICOM 设备或软件的制造商会将 ImplementationVersionName 的值设置为特定的版本号或修订号。</span><br><span class="line"></span><br><span class="line">            //Patient Info</span><br><span class="line">            string patientName = dcmDataset.Get&lt;string&gt;(DicomTag.PatientName, &quot;&quot;);</span><br><span class="line">            //Get&lt;T&gt; 方法是 Dicom 数据集中的一个通用方法，用于获取指定标签号（Tag）对应的值，并将其转换为指定类型 T。在这里DicomTag.PatientName是一个表示患者姓名的标签号，并且使用空字符作为默认值。</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(patientName))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(patientName);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加患者姓名信息</span><br><span class="line">            string patientID = dcmDataset.Get&lt;string&gt;(DicomTag.PatientID, &quot;&quot;);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(patientID))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0020&quot;);</span><br><span class="line">                newItem.SubItems.Add(patientID);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加患者ID信息</span><br><span class="line">            string patientBirth = dcmDataset.Get&lt;string&gt;(DicomTag.PatientBirthDate);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(patientBirth))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0030&quot;);</span><br><span class="line">                newItem.SubItems.Add(patientBirth);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加患者生日信息</span><br><span class="line">            string patientSex = dcmDataset.Get&lt;string&gt;(DicomTag.PatientSex);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(patientSex))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0040&quot;);</span><br><span class="line">                newItem.SubItems.Add(patientSex);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加患者性别信息</span><br><span class="line">            string patientAge = dcmDataset.Get&lt;string&gt;(DicomTag.PatientAge);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(patientAge))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;1010&quot;);</span><br><span class="line">                newItem.SubItems.Add(patientAge);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加患者年龄信息</span><br><span class="line">            //Study &amp; Series Info</span><br><span class="line">            string studyDate = dcmDataset.Get&lt;string&gt;(DicomTag.StudyDate);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(studyDate))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0008&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0020&quot;);</span><br><span class="line">                newItem.SubItems.Add(studyDate);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加检查日期信息</span><br><span class="line">            string studyTime = dcmDataset.Get&lt;string&gt;(DicomTag.StudyTime);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(studyTime))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0008&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0030&quot;);</span><br><span class="line">                newItem.SubItems.Add(studyTime);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加检查的具体时间，包括时分秒和毫秒</span><br><span class="line">            string studyInstanceID = dcmDataset.Get&lt;string&gt;(DicomTag.StudyInstanceUID);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(studyInstanceID))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0020&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;000D&quot;);</span><br><span class="line">                newItem.SubItems.Add(studyInstanceID);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加病人检查唯一标志符信息，用于唯一标识病人的一次检查（即一个 study），它是一个由数字和句点组成的字符串，全球唯一，可用于跨医院或跨系统的病人信息交换。</span><br><span class="line">            string seriesInstanceID = dcmDataset.Get&lt;string&gt;(DicomTag.SeriesInstanceUID);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(seriesInstanceID))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0020&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;000E&quot;);</span><br><span class="line">                newItem.SubItems.Add(seriesInstanceID);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加了一次检查中某个影像序列的唯一标识符，SeriesInstanceUID 标签用于唯一标识一组相关的影像（即一个 series），它也是一个由数字和句点组成的字符串，全球唯一。</span><br><span class="line">            string studyID = dcmDataset.Get&lt;string&gt;(DicomTag.StudyID);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(studyID))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0020&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(studyID);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加了病人的检查编号信息。StudyID 标签用于识别一个病人的检查，通常由医院或机构自己定义。</span><br><span class="line">            //Image Info</span><br><span class="line">            string imageHeight = dcmDataset.Get&lt;string&gt;(DicomTag.Rows);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(imageHeight))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0028&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0010&quot;);</span><br><span class="line">                newItem.SubItems.Add(imageHeight);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加图像高度信息，图像高度就是像素行数，也即Rows</span><br><span class="line">            string imageWidth = dcmDataset.Get&lt;string&gt;(DicomTag.Columns);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(imageWidth))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0028&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0011&quot;);</span><br><span class="line">                newItem.SubItems.Add(imageWidth);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加图像宽度信息，图像宽度就是像素列数，也即Columns</span><br><span class="line">            string bitsAlloctaed = dcmDataset.Get&lt;string&gt;(DicomTag.BitsAllocated);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(bitsAlloctaed))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0028&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0100&quot;);</span><br><span class="line">                newItem.SubItems.Add(bitsAlloctaed);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加图像像素深度信息，图像像素深度就是像素所占用的位数，常见位数为8，16，32.</span><br><span class="line">            string bitsStored = dcmDataset.Get&lt;string&gt;(DicomTag.BitsStored);</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(bitsStored))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0028&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0101&quot;);</span><br><span class="line">                newItem.SubItems.Add(bitsStored);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加图像实际像素深度信息。在DICOM中，像素深度可以分配比实际位深度更多的位，但实际位深度表示图像实际存储的精度。通常情况下，实际位深度等于或小于像素深度。</span><br><span class="line">            string highBits = dcmDataset.Get&lt;string&gt;(DicomTag.HighBit);</span><br><span class="line">            //这行代码是用于从DICOM数据集中获取像素值中最高位的位位置。在DICOM中，像素值是一个整数，其位数由像素深度决定，每个像素值可以被解释为灰度值或颜色分量等。</span><br><span class="line">            if (!String.IsNullOrWhiteSpace(highBits))</span><br><span class="line">            &#123;</span><br><span class="line">                ListViewItem newItem = new ListViewItem(&quot;0028&quot;);</span><br><span class="line">                newItem.SubItems.Add(&quot;0102&quot;);</span><br><span class="line">                newItem.SubItems.Add(highBits);</span><br><span class="line">                listView1.Items.Add(newItem);</span><br><span class="line">            &#125;//添加二进制像素值最高位位置信息</span><br><span class="line">            listView1.EndUpdate();//结束控件显示更新</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Drawing the image in your DCM to the Dialog</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;dcm&quot;&gt;&lt;/param&gt;</span><br><span class="line">        private void DrawingDCMData2Screen(DicomFile dcm)//在窗口上显示dicom影像的bmp格式图象</span><br><span class="line">        &#123;</span><br><span class="line">            pictureBox1.Image = ConvertDCMData2BitImage(dcm);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /// &lt;summary&gt;</span><br><span class="line">        /// Convert the byte data retrieved from DCM file to Image</span><br><span class="line">        /// &lt;/summary&gt;</span><br><span class="line">        /// &lt;param name=&quot;imagedata&quot;&gt;&lt;/param&gt;</span><br><span class="line">        /// &lt;returns&gt;&lt;/returns&gt;</span><br><span class="line">        private Bitmap ConvertDCMData2BitImage(DicomFile dcm)//将dcm格式转换为bmp格式</span><br><span class="line">        &#123;</span><br><span class="line">            DicomFile newDcmFile = null;//定义一个空dicom文件用于存放压缩dicom文件实例</span><br><span class="line">            if (dcm.FileMetaInfo.TransferSyntax.IsEncapsulated)//判断传输语法是否被压缩</span><br><span class="line">            &#123;</span><br><span class="line">               // System.Reflection.Assembly.LoadFrom(Path.Combine(Application.StartupPath,&quot;Dicom.Native64.dll&quot;));</span><br><span class="line">                DicomTranscoder.LoadCodecs(Application.StartupPath, &quot;Dicom.Native*.dll&quot;);</span><br><span class="line">                newDcmFile=dcm.ChangeTransferSyntax(DicomTransferSyntax.ExplicitVRLittleEndian,new DicomJpegLsParams());//使用ExplicitVRLittleEndian传输语法，指定图像压缩算法以便后续处理            </span><br><span class="line">            &#125;</span><br><span class="line">            DicomImage imageDcm=null;//定义空的dicom图像类用于存放压缩dicom文件的图像信息</span><br><span class="line">            if (newDcmFile != null)//如果是被压缩的dicom文件，那么newDcmFile非空</span><br><span class="line">                imageDcm = new DicomImage(newDcmFile.Dataset);//将newDcmFile的数据集作为参数创建dicom图像类对象</span><br><span class="line">            else</span><br><span class="line">                imageDcm = new DicomImage(dcm.Dataset);//不是压缩文件就直接使用函数传入的dcm文件</span><br><span class="line">            DicomDataset dataset = dcm.Dataset;//使用变量方便传输</span><br><span class="line">            byte[] fs = imageDcm.PixelData.NumberOfFrames &lt; 2 ? imageDcm.PixelData.GetFrame(0).Data : imageDcm.PixelData.GetFrame(1).Data;//使用条件运算符判断是否是多帧图像，如果图象只有一帧，那么就是使用第0帧的图像数据，如果是多帧图像，那么就选用第1帧的图像数据。将图像数据存放在字节类型的数组fs中。</span><br><span class="line">            uint size = (uint)Marshal.SizeOf(typeof(short));//获取short类型的大小用于后续处理</span><br><span class="line">            uint padding = (uint)fs.Length % size;//字节数组长度与 short 类型大小的余数</span><br><span class="line">            uint count = (uint)fs.Length / size;//字节数组长度与 short 类型大小的商</span><br><span class="line">            short[] values = new short[count];//创建short类型数组存放基本的16位像素单元</span><br><span class="line">            System.Buffer.BlockCopy(fs, 0, values, 0, (int)(fs.Length - padding));//将字节数组复制到short类型数组中</span><br><span class="line"></span><br><span class="line">            int height = dataset.Get&lt;int&gt;(DicomTag.Rows);//获取图像高度，也即行数</span><br><span class="line">            int width = dataset.Get&lt;int&gt;(DicomTag.Columns);//获取图像宽度，也即列数</span><br><span class="line">            int windowsWidth = (int)dataset.Get&lt;double&gt;(DicomTag.WindowWidth);//窗宽定义</span><br><span class="line">            int windowsCenter = (int)dataset.Get&lt;double&gt;(DicomTag.WindowCenter);//窗位定义</span><br><span class="line">            //if the windowsWidth = 0, the DCM file is not standard type.</span><br><span class="line">            if (windowsWidth == 0 || windowsCenter==0)//对非标准dicom文件进行处理，并进行相应窗位窗宽计算</span><br><span class="line">            &#123;</span><br><span class="line">                windowsWidth = values.Max&lt;short&gt;()-values.Min&lt;short&gt;();</span><br><span class="line">                windowsCenter = windowsWidth / 2;</span><br><span class="line">            &#125;</span><br><span class="line">            int low = windowsCenter - windowsWidth / 2;//计算窗的范围</span><br><span class="line">            int high = windowsCenter + windowsWidth / 2;</span><br><span class="line">            Bitmap bitmap = new Bitmap(width, height);</span><br><span class="line">            for (int i = 0; i &lt; height; ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                for (int j = 0; j &lt; width; ++j)</span><br><span class="line">                &#123;</span><br><span class="line">                    int r, g, b;</span><br><span class="line">                    int temp = (int)values[(width - j - 1) * height + i];</span><br><span class="line">                    int val = temp &gt; high ? 255 : (temp &lt; low ? 0 : ((temp - low) * 255 / windowsWidth));</span><br><span class="line">                    r = g = b = val;</span><br><span class="line">                    bitmap.SetPixel(i, width-j-1, Color.FromArgb(r, g, b));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;//相当于从第一行末端到第一行第一个元素使用数组元素进行像素值赋值，接着第二行末端到第二行第一个元素，以此类推。</span><br><span class="line">            return bitmap;//返回Bitmap类型对象</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private void aboutToolStripMenuItem_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            MessageBox.Show(&quot;The program is just a demo written by C# using fo-dicom!****zssure****&quot;);</span><br><span class="line">        &#125;//帮助里的help提示</span><br><span class="line"></span><br><span class="line">        private void closeToolStripMenuItem_Click(object sender, EventArgs e)</span><br><span class="line">        &#123;</span><br><span class="line">            listView1.Items.Clear();//清空ListView控件</span><br><span class="line">            pictureBox1.Image = Image.FromFile(defaultImageBG);//将图像替换成默认背景</span><br><span class="line">            MessageBox.Show(&quot;The close is just back to original state.Please click &#x27;X&#x27; to exit! &quot;);</span><br><span class="line">        &#125;//close选项提示</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/C-%E5%AD%A6%E4%B9%A0/">C#学习</category>
      
      
      
      <comments>http://example.com/2023/06/18/Csharp/%E4%BA%8C/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>基础学习一</title>
      <link>http://example.com/2023/03/16/Csharp/%E4%B8%80/</link>
      <guid>http://example.com/2023/03/16/Csharp/%E4%B8%80/</guid>
      <pubDate>Wed, 15 Mar 2023 16:10:10 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;C-程序结构&quot;&gt;&lt;a href=&quot;#C-程序结构&quot; class=&quot;headerlink&quot; title=&quot;C#程序结构&quot;&gt;&lt;/a&gt;C#程序结构&lt;/h2&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="C-程序结构"><a href="#C-程序结构" class="headerlink" title="C#程序结构"></a>C#程序结构</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">using System;</span><br><span class="line">namespace HelloWorldApplication</span><br><span class="line">&#123;</span><br><span class="line">   class HelloWorld</span><br><span class="line">   &#123;</span><br><span class="line">      static void Main(string[] args)</span><br><span class="line">      &#123;</span><br><span class="line">         Console.WriteLine(&quot;Hello World&quot;);</span><br><span class="line">         Console.ReadKey();</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>一个C#程序包含以下部分：</p><ul><li><strong>使用using关键字包含命名空间，一个程序一般有多个using语句。</strong>相当于System是一个系统命名空间，可以使用其中的类和方法。类比一下java的package，但是还是有去别的。</li><li><strong>命名空间声明。</strong>使用namespace关键字定义一个命名空间。</li><li><strong>一个class。</strong>class声明类包含了程序使用的数据和方法声明。类一般包含多个方法。方法定义了类的行为。只有一个  Main 方法。</li><li><strong>Class方法。</strong></li><li><strong>Class属性</strong>。</li><li><strong>一个Main方法。</strong></li><li><strong>语句&amp;表达式</strong></li></ul><h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p>直接来看一个例子</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">using System;//包含系统包</span><br><span class="line">namespace RectangleApplication//定义命名空间</span><br><span class="line">&#123;</span><br><span class="line">    class Rectangle//定义矩形类</span><br><span class="line">    &#123;</span><br><span class="line">        // 成员变量</span><br><span class="line">        double length;</span><br><span class="line">        double width;</span><br><span class="line">        public void Acceptdetails()//定义获取成员变量值的函数</span><br><span class="line">        &#123;</span><br><span class="line">            length = 4.5;    </span><br><span class="line">            width = 3.5;</span><br><span class="line">        &#125;</span><br><span class="line">        public double GetArea()//定义计算面积的函数</span><br><span class="line">        &#123;</span><br><span class="line">            return length * width;</span><br><span class="line">        &#125;</span><br><span class="line">        public void Display()//定义显示函数</span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(&quot;Length: &#123;0&#125;&quot;, length);</span><br><span class="line">            Console.WriteLine(&quot;Width: &#123;0&#125;&quot;, width);</span><br><span class="line">            Console.WriteLine(&quot;Area: &#123;0&#125;&quot;, GetArea());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">    class ExecuteRectangle//定义主函数类</span><br><span class="line">    &#123;</span><br><span class="line">        static void Main(string[] args)//Main方法，程序入口</span><br><span class="line">        &#123;</span><br><span class="line">            Rectangle r = new Rectangle();//实例化矩形类，r为标识符，避免和C#关键字重复，如果非要用加一个@</span><br><span class="line">            r.Acceptdetails();//调用类的方法</span><br><span class="line">            r.Display();</span><br><span class="line">            Console.ReadLine();//等待输入退出程序</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C-封装"><a href="#C-封装" class="headerlink" title="C#封装"></a>C#封装</h2><ul><li><strong>public</strong>：所有对象都可以访问；</li><li><strong>private</strong>：对象本身在对象内部可以访问；</li><li><strong>protected</strong>：只有该类对象及其子类对象可以访问</li><li><strong>internal</strong>：同一个程序集的对象可以访问；</li><li><strong>protected</strong> <strong>internal</strong>：访问限于当前程序集或派生自包含类的类型。</li></ul><img src="\images\Csharp\一\1.png" style="zoom:120%;"><h2 id="C-方法"><a href="#C-方法" class="headerlink" title="C#方法"></a>C#方法</h2>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/C-%E5%AD%A6%E4%B9%A0/">C#学习</category>
      
      
      
      <comments>http://example.com/2023/03/16/Csharp/%E4%B8%80/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>dicom影像显示</title>
      <link>http://example.com/2023/03/06/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E5%BD%B1%E5%83%8F%E6%98%BE%E7%A4%BA/</link>
      <guid>http://example.com/2023/03/06/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E5%BD%B1%E5%83%8F%E6%98%BE%E7%A4%BA/</guid>
      <pubDate>Mon, 06 Mar 2023 10:08:44 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;位图显示方法&quot;&gt;&lt;a href=&quot;#位图显示方法&quot; class=&quot;headerlink&quot; title=&quot;位图显示方法&quot;&gt;&lt;/a&gt;位图显示方法&lt;/h2&gt;&lt;p&gt;Windows位图有两种：&lt;strong&gt;DDB&lt;/strong&gt;以及&lt;strong&gt;DIB&lt;/strong</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="位图显示方法"><a href="#位图显示方法" class="headerlink" title="位图显示方法"></a>位图显示方法</h2><p>Windows位图有两种：<strong>DDB</strong>以及<strong>DIB</strong>。</p><p><strong>DDB</strong>中不包含调色板，通过硬件设备来显示图像，位图在内存中的位置和结构由硬件的驱动程序来管理,类似于MFC205中的Cbitmap类。由于不包含有调色板，图像的显示由硬件设备直接来实现，所以这种显示方式的速度非常快，与此同时，因为它的显示是依赖于设备的，所以在不同设备之间是不能够实现文件的兼容应用，从而决定了DDB的应用范围非常有限。</p><p><strong>DIB</strong>设备无关位图却克服了DDB的确定，它不再依赖于硬件设备，是一种外部图像格式，从而完全能够实现不同设备之间的文件兼容应用。由于DIB位图中包含了一个调色板，而图像中的像素值表示了对应于该调色板的查找值，虽然相对于DDB位图多了一项查找过程，但是，DIB位图实现了不同设备之间的兼容显示，当需要显示图像的时候，只需要通过像素值找到调色板中对应的颜色进行显示，而不在关心硬件设备是否支持图像显示，从而实现了独立于硬件设备，所以目前大多数应用的图像基本都属于DIB类型。Windows中所有的图像生成都是由图形设备接口GDI来管理的，GDI是通过应用高层的绘图函数来实现生成的图像的，正由于这种生成方式，所以无论何种硬件设备都能够生成同样的图形，因此GDI构成了Windows系统的核心部件。</p><h2 id="DICOM显示流程"><a href="#DICOM显示流程" class="headerlink" title="DICOM显示流程"></a>DICOM显示流程</h2><p>不同的操作系统中字节数据的排列顺序是不同的，一般主要有两种排列方式，即Big Endian和Little Endian。前者表示系统中的字节数据采用正常的顺序进行排列，而后者恰恰相反，采用高低字节调换的方式进行数据排列。通常情况下，在UNIX系统中采用正常顺序的Big Endian排列方式，而Windows中则采用髙低字节调换的Little Endian排列方式。</p><p>数据解析流程：</p><div id="flowchart-0" class="flow-chart"></div><p>DICOM-BMP显示流程：</p><div id="flowchart-1" class="flow-chart"></div><h2 id="图像标注"><a href="#图像标注" class="headerlink" title="图像标注"></a>图像标注</h2><p>做为医学图像显示系统，对图像中重点关注区域的加以标注是不可或缺的，可以辅助医生对其感兴趣区域进行锁定和定性分析。同时标记对医学教学也是非常有帮助的。本文中设计的对DICOM文件中图像的热点关注区域进行标注，并对所标注的轨迹坐标等信息进行读取和保存。对影像图像进行标记，针对影像图像可能涉及到很多部位，及不同的病状，本设计采用画线、圆形、矩形三种标记方式对其进行标记定位。</p><p>主要实现方法是通过调用Windows系统下的CClientDC类，以鼠标左键按下为坐标起点，以鼠标左键弹起为坐标终点，这样就能够画出标记线。</p><h2 id="图像的旋转和放大"><a href="#图像的旋转和放大" class="headerlink" title="图像的旋转和放大"></a>图像的旋转和放大</h2><p><strong>图像旋转</strong>就是以空间的某一点为原点，然后改变旋转角度，但是每一点的相对位置关系是不变的。从数学方法上来描述，图像的旋转就是建立一幅图像与其变换后的图像中所有像素点之间映射关系的函数:(x,y)=(X(u,v),Y(u,v)),(x,y)表示输入的图像素点的坐标，(u,v)表示输出的图像素点的坐标。x,y,u,v表示了输入图像与输出图像所有点的几何对应关系。图像的旋转计算方法为:假设在X-Y坐标体系中，将点(x,y)旋转角度θ，得到点(u,v)。</p><p>计算公式为：</p><script type="math/tex; mode=display">[u,v] = [x,y]\begin{bmatrix}cos\theta & -sin\theta \\ sin\theta & sin\theta\end{bmatrix}</script><p><strong>图像放大</strong>可以更好的帮助医生诊断，其最简单的方法就是将像素放大，变换的公式为：</p><script type="math/tex; mode=display">u = r_x * x\\v = r_y * y</script><p>其中<code>r_x</code>为X方向的放大比例，7；为y方向的放大比例，然后将变换后的像素排列在的阵列中，但是这样的放大只是像素坐标的间隔变大。所以这样的放大以后会产生马赛克，为了解决这一问题，通常采用插值法来实现像素的平稳过度。</p><p><img src="\images\毕设\dicom标准\6.jpg" style="zoom:50%;"></p><p>图中的四个边角为放大后原像素的位置，而它们之间的像素需要插值来显示，具体算法如下：</p><script type="math/tex; mode=display">g(u,v_1) = g(u_1,v_1)+\frac{u-u_1} {u_2-u_1}[g(u_2,v_1)-g(u_1,v_1)]\\g(u,v_2) = g(u_1,v_2)+\frac{u-u_1} {u_2-u_1}[g(u_2,v_2)-g(u_1,v_2)]\\g(u,v) = g(u,v_1)+\frac{v-v_1} {v_2-v_1}[g(u,v_2)-g(u,v_1)]</script><p>由于是通过线性插值的方法得到的放大图像，所以效果明显优于直接放大法，但是即使采用了插值旳方法，所得到的信息毕竟不是真实的信息，所以只能作为医学诊断辅助，不是绝对严格的医学测量。</p><p><script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.2.7/raphael.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.6.5/flowchart.min.js"></script><textarea id="flowchart-0-code" style="display: none">st=>start: 开始op=>operation: 读取数据cond=>condition: Big Endian?op2=>operation: 数据处理op3=>operation: 字节交换e=>end: 结束st->op->cond->op2->econd(yes)->op2cond(no)->op3op3->op2</textarea><textarea id="flowchart-0-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-0-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-0", options);</script><textarea id="flowchart-1-code" style="display: none">st=>start: 开始e=>end: 结束op1=>operation: 打开文件op2=>operation: 提取传输输入法op3=>operation: 数据解析op4=>operation: 获取图像数据信息op5=>operation: 数据解析op6=>operation: 调用相应解压模块op7=>operation: 获取图像数据op8=>operation: 图像数据转换为8位数据op9=>operation: DIB显示cond1=>condition: DICOM？cond2=>condition: 图像是否为压缩数据？st->op1->cond1(yes)->op2->op3->op4->op5->cond2(no)->op7->op8->op9->econd1(no)->econd2(yes)->op6->op7</textarea><textarea id="flowchart-1-options" style="display: none">{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}</textarea><script>  var code = document.getElementById("flowchart-1-code").value;  var options = JSON.parse(decodeURIComponent(document.getElementById("flowchart-1-options").value));  var diagram = flowchart.parse(code);  diagram.drawSVG("flowchart-1", options);</script></p>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</category>
      
      
      
      <comments>http://example.com/2023/03/06/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E5%BD%B1%E5%83%8F%E6%98%BE%E7%A4%BA/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>dicom图像灰度理解</title>
      <link>http://example.com/2023/03/05/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E5%9B%BE%E5%83%8F%E7%81%B0%E5%BA%A6%E7%90%86%E8%A7%A3/</link>
      <guid>http://example.com/2023/03/05/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E5%9B%BE%E5%83%8F%E7%81%B0%E5%BA%A6%E7%90%86%E8%A7%A3/</guid>
      <pubDate>Sun, 05 Mar 2023 13:17:39 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;图像灰阶&quot;&gt;&lt;a href=&quot;#图像灰阶&quot; class=&quot;headerlink&quot; title=&quot;图像灰阶&quot;&gt;&lt;/a&gt;图像灰阶&lt;/h2&gt;&lt;p&gt;​        所谓灰阶，是将最亮与最暗之间的亮度变化，区分为若干份。以便于进行信号输入相对应的屏幕亮度管控。每张数字影像</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="图像灰阶"><a href="#图像灰阶" class="headerlink" title="图像灰阶"></a>图像灰阶</h2><p>​        所谓灰阶，是将最亮与最暗之间的亮度变化，区分为若干份。以便于进行信号输入相对应的屏幕亮度管控。每张数字影像都是由许多点所组合而成的,这些点又称为像素(pixels)，通常每一个像素可以呈现出许多不同的颜色，它是由红、绿、蓝（RGB）三个子像素组成的。每一个子像素，其背后的光源都可以显现出不同的亮度级别。而灰阶代表了由最暗到最亮之间不同亮度的层次级别。这中间层级越多，所能够呈现的画面效果也就越细腻。以8bit panel为例，能表现2的8次方，等于256个亮度层次，我们就称之为256灰阶。LCD屏幕上每个像素，均由不同亮度层次的红、绿、蓝组合起来，最终形成不同的色彩点。也就是说，屏幕上每一个点的色彩变化，其实都是由构成这个点的三个RGB子像素的灰阶变化所带来的。</p><h2 id="RGB"><a href="#RGB" class="headerlink" title="RGB"></a>RGB</h2><p>​        我们生活中通过三原色深浅组成不同的颜色，前端开发中常用RGB来指定色彩，R、G、B 都是 0-255， 比如 （255,255,255） 表示白色，用16进制表示255就是ff, 所以255,255,255 可以表示为 ffffff,  在css样式表中写为 #ffffff。</p><h2 id="像素"><a href="#像素" class="headerlink" title="像素"></a>像素</h2><p>​        图片我们都知道是由多个像素组成的，是图像的最小单元，如果这个单元里只有一个bit大小，也就是只有0和1两个值，由这种像素组成的图像称二值图像，显然它可以表示一个黑白图。这个单位里也可以存一个16位二进制数，24位…, 可以想象存储的越大，一个像素能表达的颜色就越丰富，整体图像呈现就越精细，当然图片占用的空间也就越大。</p><h2 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h2><p>​        1位图像（即二值图像）只能表示黑白，那二位图像就可以表示4种颜色（00,01,10,11，VGA），依次类推，4位（16色，VGA），8位（256色），16位（增强色），24位和32位（真彩色）等。</p><p>这其中8位RGB指的是3位元是R，3位元是G，2位元是B，故有8位RGB有256种颜色。其他以此类推。</p><p><strong>色彩图像</strong>：以RGB图像为例，RGB图像每一个像素的颜色值（由RGB三原色表示）直接存放在图像矩阵中，由于每一像素的颜色需由R、G、B三个分量来表示，M、N分别表示图像的行列数，<strong>三个</strong>M x N的二维矩阵分别表示各个像素的R、G、B三个颜色分量，假设我们在绘图的时候只取第一个矩阵，那么绘制出来的就是红色分量的图片。<br> <strong>灰度图像</strong>：每个像素只有一个采样颜色，这类图像通常显示为从最暗黑色到最亮的白色的灰度，尽管理论上这个采样可以任何颜色的不同深浅，甚至可以是不同亮度上的不同颜色。</p><h2 id="灰度级"><a href="#灰度级" class="headerlink" title="灰度级"></a>灰度级</h2><p>​        灰度级表明图像中不同灰度的最大数量。灰度级越大，图像的亮度范围越大。二值图像一个像素只能存0和1，它的灰度级就为2，8位图一个像素表示0-255共256个灰度值，所有它的灰度级为256， 那么存储一张512*512,256级灰度的图片需要的空间就为</p><script type="math/tex; mode=display">512*512*8 = 2097152\ bit ≈ 1.7\ Mb</script><h2 id="图像灰度化"><a href="#图像灰度化" class="headerlink" title="图像灰度化"></a>图像灰度化</h2><p>​        图像的灰度化是让像素点矩阵中的每一个像素点都满足关系：R=G=B，此时的这个值叫做灰度值。如RGB(100,100,100)就代表灰度值为100,RGB(50,50,50)代表灰度值为50。</p>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</category>
      
      
      
      <comments>http://example.com/2023/03/05/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E5%9B%BE%E5%83%8F%E7%81%B0%E5%BA%A6%E7%90%86%E8%A7%A3/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>dicom窗位和窗宽</title>
      <link>http://example.com/2023/03/05/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E7%AA%97%E4%BD%8D%E7%AA%97%E5%AE%BD/</link>
      <guid>http://example.com/2023/03/05/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E7%AA%97%E4%BD%8D%E7%AA%97%E5%AE%BD/</guid>
      <pubDate>Sun, 05 Mar 2023 12:27:05 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; class=&quot;headerlink&quot; title=&quot;问题&quot;&gt;&lt;/a&gt;问题&lt;/h2&gt;&lt;p&gt;普通显示器能显示的最大灰度值是8bit (256位，即0~255)， 而医学图像的最大灰度值通常不低于12bit，所以普通的显示器就难以直接</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>普通显示器能显示的最大灰度值是8bit (256位，即0~255)， 而医学图像的最大灰度值通常不低于12bit，所以普通的显示器就难以直接显示医学图像的全部灰度信息。</p><h2 id="CT值定义"><a href="#CT值定义" class="headerlink" title="CT值定义"></a>CT值定义</h2><p>是测定人体某一局部组织或器官密度大小的一种计量单位，通常称亨氏单位（hounsfield unit ，HU）空气为-1000，致密骨为+1000。</p><p><strong>CT 值</strong>是CT 图像中各组织与X 线衰减系数相当的对应值。无论是矩阵图像或矩阵数字都是CT 值的代表，而CT 值又是从人体组织、器官的μ值换算而来的。 CT 值不是绝对不变的数值，它不仅与人体内在因素如呼吸、血流等有关，而且与X 线管电压、CT 装置、室内温度等外界因素有关。</p><p>人体常见组织CT值：</p><p><img src="\images\毕设\dicom标准\5.jpg" style="zoom:80%;"></p><h2 id="窗位窗宽调节"><a href="#窗位窗宽调节" class="headerlink" title="窗位窗宽调节"></a>窗位窗宽调节</h2><p><strong><em>定义</em>：</strong> 在不影响视觉效果的前提下，将高精度医学图像的较大范围内的灰度值<strong>逐段映射</strong>为普通显示器可以显示的0~255范围内的灰度，通过不断调节窗宽窗位将所有的高精度医学图像信息逐段显示出来，这个过程称为窗宽窗位调节。</p><ul><li><p><strong>窗宽：</strong>window width (ww) 图像数据的显示范围，是CT图像上显示的CT值范围。</p><p>在此CT值范围内的组织和病变均以不同的模拟灰度显示。而CT值高于此范围的组织和病变，无论高出程度有多少，均以白影显示，不再有灰度差异；反之，低于此范围的组织结构，不论低的程度有多少，均以黑影显示，也无灰度差别。增大窗宽，则图像所示CT值范围加大，显示具有不同密度的组织结构增多，但各结构之间的灰度差别减少。减小窗宽，则显示的组织结构减少，然而各结构之间的灰度差别增加。如观察脑质的窗宽常为-15～+85H，即密度在-15～+85H范围内的各种结构如脑质和脑脊液间隙均以不同灰度显示。而高于+85H的组织结构如骨质几颅内钙化，其间虽有密度差，但均以白影显示，无灰度差别；而低于-15H组织结构如皮下脂肪及乳突内气体均以黑影显示，其间也无灰度差别。</p></li><li><p><strong>窗位：</strong>window level (wl) 图像数据显示的中心值，即CT值范围的中心值。</p><p>窗位是窗的中心位置，同样的窗宽，由于窗位不同，其所包括CT值范围的CT值也有差异。例如窗宽同为100H，当窗位为0H时，其CT值范围为-50～+50H；如窗位为+35H时，则CT值范围为-15～+85H。通常，欲观察某以组织结构及发生的病变，应以该组织的CT值为窗位。例如脑质CT值约为+35H，则观察脑组织及其病变时，选择窗位以+35H为妥。</p></li></ul><p>拿 ww: 500 wl: 200 举例说明。它表示将窗宽是500，窗位200的灰度映射到8bit来显示，即将灰度范围是 -50 ~ 450 的像素映射到 0 ~ 255。</p><p><img src="\images\毕设\dicom标准\4.jpg" style="zoom:80%;"></p><p>设窗宽为w, 窗位为c，要映射的区间宽度为g (0~255的宽度是256)，那么对于图像中灰度大于<code>c + w/2</code> 的全部设置为255，  小于 <code>c -w/2</code> 的全部设置为0； 也就是大于450的全部映射为255，而小于-50的全部映射为0； 在-50 ~ 450 范围的则采用线性映射函数<code>y = ax + b</code> 进行映射，其中 <code>a = g/w , b = (w/2-c)g/w</code>。具体计算公式如下：</p><script type="math/tex; mode=display">f(x) =\left \{ \begin{array}{c}0\ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,x < c-\frac{w}{2} \\ \frac{g}{w}*x+(\frac{w}{2}-c)*\frac{g}{w}\ \ ,c-\frac{w}{2}≤ x < c+\frac{w}{2}\\ 255\  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,x≥c+\frac{w}{2}\end{array}\right.</script><p>上述只是线性转换的一种，也有博客或者书本中将256 取值为255。如果窗宽非常大，比如25500 压缩到0~255就是100:1, 这样的损失可能会很大，这时候可以考虑使用非线性转换，常用算法有log和gamma。</p><h2 id="窗宽窗位选择"><a href="#窗宽窗位选择" class="headerlink" title="窗宽窗位选择"></a>窗宽窗位选择</h2><p>在医院领域，不同组织使用不同窗宽窗位,能较充分反映解剖内容和病灶影像表现，比如头颅,脑组织的窗宽设定为80Hu~100Hu,窗位为30 Hu~40 Hu。</p><p>DICOM中，Hu = pixel * slope + intercept 其中pixel是像素值（DICOM是灰度图像，像素值即灰度值），slope是斜率，intercept是截距。</p>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</category>
      
      
      
      <comments>http://example.com/2023/03/05/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E7%AA%97%E4%BD%8D%E7%AA%97%E5%AE%BD/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>dicom简介</title>
      <link>http://example.com/2023/03/04/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E7%AE%80%E4%BB%8B/</link>
      <guid>http://example.com/2023/03/04/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E7%AE%80%E4%BB%8B/</guid>
      <pubDate>Sat, 04 Mar 2023 11:47:57 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;dicom基本概念和定义&quot;&gt;&lt;a href=&quot;#dicom基本概念和定义&quot; class=&quot;headerlink&quot; title=&quot;dicom基本概念和定义&quot;&gt;&lt;/a&gt;dicom基本概念和定义&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;实体(Entity):&lt;/</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="dicom基本概念和定义"><a href="#dicom基本概念和定义" class="headerlink" title="dicom基本概念和定义"></a>dicom基本概念和定义</h2><ul><li><p><strong>实体(Entity):</strong>表示一个或者一类具有相同特性的应用对象。 </p></li><li><p><strong>关系(Relation):**</strong>表示各个实体之间的相互关系。比如医疗影像设备和患者之间，存在的就是检查的关系。</p></li><li><p><strong>实体-关系（E-R)模型：</strong>描述实际中具体的物体或者概念的一种信息模型。通过定义实体和实体间的关系，从而表达出系统所实现的功能。</p></li><li><p><strong>对象(Object):</strong>即现实中的实际事物在计算机内部的抽象表达，它包含了事物的属性以及对事物的处理方法，并且具有封装与继承的特征。</p></li><li><p><strong>唯一标识符UID:</strong>此标志无论在世界上的任何地点都是独一无二的，为了保证其唯一性，它的产生机制如下：&lt;根&gt;.&lt;后缀&gt;，即由根和后缀两部分组成，其中根部分是由权威部门来制定的，通过权威部门来确保它的唯一性，之后再通过其他的机构部门分配到医院，同时也必须要保证其在内部网络的唯一性。</p></li><li><p><strong>信息对象定义(Information Object Definition,==lOD==)：**</strong>指的是信息实体的集合。每一个信息实体都是一个单独的对象属性，例如人的名字就是人这一对象的信息实体，当这些信息实体组合到特定的模块中就会形成数据集。在DICOM中一个IOD可以包含单个的信息实体也可以包含多个信息实体。通常情况下，管理功能的服务类使用的是包含单个信息实体的IOD，而处理图像的服务类使用的则是包含有多个信息实体的IOD。</p></li><li><p><strong>服务(Service):**</strong>服务指的是为其他应用程序所提供的功能，通过下层服务原语和信息对象来实现服务的功能。服务类指的是将一项用于对象的指令抽象出来进行描述，比如用于对象的命令和结果。服务类中包含了应用实体的概念，指的是一个实际的应用程序。服务中包括有服务类提供者和服务类使用者，服务类提供者是提供DICOM服务的应用实体，服务类使用者则是通过网络要求DICOM服务的应用实体。</p></li></ul><ul><li><strong>服务对象对(Service Object Pair,==SOP==)：</strong>它是传递DICOM信息的基本单位。每一个DICOM都包含一个SOP类，而这个SOP类表示的是实际对象，SOP根据UID来进行唯一表示，并且其类型可根据UID来识别，DICOM应用实体可以支持一个或多个SOP类。</li></ul><h2 id="dicom标准信息模型"><a href="#dicom标准信息模型" class="headerlink" title="dicom标准信息模型"></a>dicom标准信息模型</h2><p>DICOM的信息模型中主要包含有四个层次：病人层次(Patient)、研究层次(Study)、序列层次(Series)以及图像层次(Image)。</p><ul><li><p><strong>病人层次（Patient):</strong>病人IOD封装了该病人的基本信息。如病人姓名、性别、年龄、身高以及体重等基本信息。</p></li><li><p><strong>研究层次（Study):</strong>研究层次表示对特定类型请求的一个结果，它是DICOM信息模型中最为关键的一部分，因为整个DICOM影像都以研究层次的正确引导而进行。研究层次也包含了一些标识信息，通过该标识信息可以连接医院的影像管理系统(HIS)。</p></li><li><p><strong>序列层次（Series):</strong>序列层次中包含的是图像的序列，同时也标识了图像相关的一些属性，如图像属于何种类型，图像生成的日期以及生成该图像所使用的设备等等。序列层次中规定了图像序列的排列类型，而图像序列的排列类型可根据具体的临床应用来决定。</p></li><li><p><strong>图像层次（Image):</strong>图像层次包含的就是DICOM中的图像数据，它也是整个信息模型的最底层。由于不同设备产生的图像不同，可以是单层的图像，也可以是双层的图像，甚至还会有一些器官的运动图像。</p></li></ul><h2 id="dicom文件结构"><a href="#dicom文件结构" class="headerlink" title="dicom文件结构"></a>dicom文件结构</h2><p>DICOM文件的组成包括两部分：即文件头和数据集，同时每个DICOM文件中还包含一个服务对象的SOP实例，其中包含了一个图像实例。</p><h3 id="dicom文件头"><a href="#dicom文件头" class="headerlink" title="dicom文件头"></a>dicom文件头</h3><p>文件头是为了保持与通用文件结构的兼容性。</p><div class="table-container"><table><thead><tr><th>组成</th><th>功能</th></tr></thead><tbody><tr><td>文件导读</td><td>由128个字节16进制数组成，主要是为了进行一些特定的操作和应用协议，方便访问其内部的图像数据以及其他的信息，通常情况下这部分无内容，即用128个字节的00H来表示</td></tr><tr><td>DICOM前缀</td><td>由4个字节组成，对应的ASCII码为“DICM”，是用来判定该文件的格式是否为DICOM</td></tr><tr><td>文件元信息元素</td><td>一些其他的信息，如文件的元信息版本、传输语法、媒介存储SOP类、文件应用类、源AE标题、私有信息以及程序生成器等等。</td></tr></tbody></table></div><h3 id="dicom数据集"><a href="#dicom数据集" class="headerlink" title="dicom数据集"></a>dicom数据集</h3><p>​        数据集是由大量的按照一定顺序排列的数据元所组成，而数据元又由四部分组成：TAG(标签)、VR(值表示)、值长度和值域。DICOM数据集描述的就是现实中一个具体事物抽象成的实例，而数据元表示的则是实例的各个属性，数据元包含的信息可以是简单的字符信息，也可以是数字信息，每个数据元按照其标签的递增方式进行排列。比如，如果将一个患者抽象成为一个实例，那么数据元表示的可以是患者的名字、年龄、性别以及患者所做的检查中包含的图像生成的日期、图像的类型和图像数据本身等等。</p><p><img src="\images\毕设\dicom标准\2.jpg" style="zoom:50%;"></p><p>（1）<strong>TAG(标签)</strong>：在DICOM数据元中，标签是用来对数据元做唯一的标识，即同一个标签在数据元中只能出现一次，但是有一种情况例外，就是当数据元使用嵌套模式的时候。标签是一个4字节的无符号整数，它由两部分组成，即组号和元素号。标签分为标准标签（Standard Data Elements Tag)和留给用户自定义的标签，一般来说，组号为偶数的标签就是标准标签，但是在制定DICOM标准的时候为了以后对DICOM的发展进行更新应用，一些特殊的标签暂时没做任何定义，也不允许自定义，包括组号为：0000、0002、0004和0006的标签，每一个标准标签的详细定义和说明都可以通过数据字典来进行查阅。组号为奇数的标签通常是留给用户自定义的标签，同样有一些特殊的例外，其中包括组号为：0001、0003、0005和0007的标签。</p><p>（2）<strong>VR(值表示）：</strong>VR表示数据元素的数据类型，由2个字节的整数组成。例如，当VR为<strong>“PN”</strong>时，表示的是病人的姓名，当VR为<strong>“UI”</strong>时，表示的是统一标识符，当VR为<strong>“AT”</strong>时，表示的是属性标签，当VR为<strong>“FL”</strong>时，表示的是数据域采用的是单精度浮点型的类型。根据传输语法的可选性，VR可分为两类：即显式和隐式，如图2-3和图2-4所示。当为显式的时候，VR不可以被省略，但是当为隐式的时候VR必须被置零省略。随着DICOM版本的发展，以前版本的一些数据类型可能在新版本不再在被支持，当VR为“RET”时，就表示该类型在DICOM3.0中不被支持，如果为了兼容使用，必须包含以前版本标准的全部有效数据，但是如果仅仅是为了兼容，而不使用这些数据，也可以不包含。当VR为“SQ”时，表示数据域里还有嵌套的子数据元，而当子数据元里的数据类型依然为“SQ”时，就形成了递归的嵌套模式，在嵌套的递归模式下，要求对DICOM进行数据解析的时候必须能够遍及所有的嵌套数据。</p><p><img src="\images\毕设\dicom标准\3.jpg" style="zoom:50%;"></p><p>（3）<strong>值长度：</strong>值长度分为两种。首先，是根据VR值是显式还是隐式的类型决定值长度用十六位或者三十二位无符号整数来表示，它说明了是值域中数据的长度的字节数，这个字节数必须是偶数。值长度仅仅表示数据元中值域数据的长度，而不包含标签、值表示和它本身的字节长度。其次，是一个固定的三十二位的字段，表示SQ嵌套模式下或者未知的数据长度，对于0B和OW的数据类型，根据协商的语法未定义的部分也可使用。</p><p>（4）<strong>值域：</strong>长度为偶数个字节，表示数据元的具体数据，VR决定了值域中数据的类型。当表示值的多重性的VM大于1的时候，说明了元素可以是多重取值。</p><h2 id="dicom图像编码"><a href="#dicom图像编码" class="headerlink" title="dicom图像编码"></a>dicom图像编码</h2><p>在图像显示方式上，DICOM采用的是位图的编码的方式，即以像素点为单位，按照从左向右，从上向下的排列方式显示出每个点的颜色和光度。不同的光度变现出DICOM图像的不同特征，DICOM标准中用Tag(0028，0004)来表示光度，通常有以下5种：</p><ul><li>MONOCHROMEI：用白色显示灰阶图像的最小值，黑色显示图像的最大值</li><li>MONOCHROMEZ：用黑色显示灰阶图像的最小值，白色显示图像的最大值</li><li>RGB：用红色、绿色和蓝色的组合显示彩色图像</li><li>HUE：用色调、饱和度和亮度的组合显示彩色图像</li><li>PALLETEC0L0R：利用调色板进行显示的彩色图像</li></ul><p>DICOM图像分为两类，即灰度图像和彩色图像。DICOM图像的像素数据分为按字节编码（VR显示为OB)和按字编码（VR显示为OW)两种。灰度图像的色彩范围就是从黑色到白色，因此每一个像素只用亮度值就可以表示。彩色图像如上所述有三种实现的方式，通常24位的RGB图像称为真彩图像，包含了计算机领域所有的颜色，显示效果最好。每一个像素的数据有以下3个因素来表示：</p><p>(1)<strong>分配位数(Bits Allocate):</strong>定义了分配给该采样值的二进制位数，数据元的标签为(0028，0100)。</p><p>(2)<strong>存储位数(Bits Stored):</strong>定义了实际使用中该采样值所占用的位数，数据元的标签为(0028，0101)表示。</p><p>(3)<strong>最高位位置(High Bit):</strong>定义了采样值最高位的位置，数据元的标签为(0028，0102)。</p><p>一个像素单元由上述的三个元素来决定，分配位数、存储位数和最高位位置分别规定了像素数据的大小、存储位数和最高位的位置。分配位数必须大于等于存储位数。当该像素点由多个采样值组合而成的时候，多个采样值将会按照一定语法规则进行排列，而当采样值小于8位时，就会按照字节的方式进行编码，当采样值大于8的时候则会以字的方式进行编码。根据语法的不同，字节的高地位顺序也会有所不同。由于原始的DICOM图像所占用的空间极其庞大，既浪费空间，输出效率也十分低下，所以在不丢失图像数据信息的条件下，去除图像的冗余部分，释放存储空间，提高传输效率是十分必要的，通常会采用压缩的方式对DICOM图像进行处理，而压缩方法包括有损压缩和无损压缩。</p><p>(1)<strong>无损压缩：</strong>顾名思义，就是在不丢失原始数据的条件下，对图像进行压缩，降低图像占用空间的一种方法。其优点就是完全不破坏原始的DICOM数据，但是缺点是压缩比较低，通常只能压缩到原始图像的二分之一到十分之一的范围内。根据其不破坏原始图像的特点，一般我们将此种压缩方法应用到对文本信息的压缩，例如患者的名字、年龄等等，这些信息必须要完整，否则无法识别。无损压缩使用的方法游程编码(Run Length Encode,RLE)以及霍夫曼(Huffman)编码等等。</p><p>(2)<strong>有损压缩：</strong>与无损压缩正好互补，它的优点就是有非常高的压缩比，可以压缩到原始图像的十分之一到二百分之一，极其有效的释放占用的存储空间，提高传输效率，可是缺点就是会丢失一些原始数据，不过对于图像声音等用人体的感觉器官感受的信息其实在一般情况下是有着很大的冗余度的，适当的丢失部分休息并不会对患者的诊断带来影响，所以这种方式通常用到DICOM图像以及动态的画面中。有损压缩通常使用的方法是变换数据的表示域，比如将数据进行傅里叶变换到频域里，然后将频域中的低频部分去掉，然后再进行傅里叶反变换，就能实现压缩。类似的方法还有很多，但是考虑到医学是一门极其严谨的学科，所以国外很多地方不提倡有损压缩，因此DICOM通常会使用RLE游程编码的无损压缩和JPEG-LS的无损压缩方式。</p>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</category>
      
      
      
      <comments>http://example.com/2023/03/04/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/dicom%E7%AE%80%E4%BB%8B/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>大纲</title>
      <link>http://example.com/2023/02/07/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/%E8%A6%81%E6%B1%82/</link>
      <guid>http://example.com/2023/02/07/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/%E8%A6%81%E6%B1%82/</guid>
      <pubDate>Tue, 07 Feb 2023 06:35:35 GMT</pubDate>
      
        
        
      <description>&lt;h2 id=&quot;选题&quot;&gt;&lt;a href=&quot;#选题&quot; class=&quot;headerlink&quot; title=&quot;选题&quot;&gt;&lt;/a&gt;选题&lt;/h2&gt;&lt;p&gt;基于fo-dicom的医学影像客户端系统设计与开发&lt;/p&gt;
&lt;h2 id=&quot;内容要求&quot;&gt;&lt;a href=&quot;#内容要求&quot; class=&quot;hea</description>
        
      
      
      
      <content:encoded><![CDATA[<h2 id="选题"><a href="#选题" class="headerlink" title="选题"></a>选题</h2><p>基于fo-dicom的医学影像客户端系统设计与开发</p><h2 id="内容要求"><a href="#内容要求" class="headerlink" title="内容要求"></a>内容要求</h2><p>1.选用一种编程语言实现DICOM协议中的C-FIND和C-MOVE功能</p><p>2.设计并实现影像数据传输的客户端系统，完成向服务器查询、申请并接收下载影像数据。完成对下载医学影像的展示、移动、缩放、旋转、调窗、加标注等操作</p><h2 id="参考论文"><a href="#参考论文" class="headerlink" title="参考论文"></a>参考论文</h2><p>1<a href="https://webvpn.whut.edu.cn/https/77726476706e69737468656265737421fbf952d2243e635930068cb8/KCMS/detail/detail.aspx?filename=1014269763.nh&dbname=CMFD201402&dbcode=cdmd&uid=WEEvREcwSlJHSldSdmVpa3VEMHZFclhEcXpKSTNqc3ZFVE5nSnJqTk8rMD0=$9A4hF_YAuvQ5obgVAqNKPCYcEjKensW4IQMovwHtwkF4VYPoHbKxJw!!&v=MTU1MzZWNzNNVkYyNkdyRytGOWJLckpFYlBJUitmbnM0eVJZYW16MTFQSGJrcVdBMEZyQ1VSN21mWk9ackZ5RG4=">医学影像DICOM的显示和处理</a></p><p>2 高效完善DICOM图像显示软件的开发研究</p><p>3 DICOM医学图像查看器的设计与实现</p>]]></content:encoded>
      
      
      <category domain="http://example.com/categories/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/">毕业设计</category>
      
      
      
      <comments>http://example.com/2023/02/07/%E6%AF%95%E4%B8%9A%E8%AE%BE%E8%AE%A1/%E8%A6%81%E6%B1%82/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>数制和码制</title>
      <link>http://example.com/2023/01/11/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/%E7%AC%AC%E4%B8%80%E7%AB%A0/</link>
      <guid>http://example.com/2023/01/11/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/%E7%AC%AC%E4%B8%80%E7%AB%A0/</guid>
      <pubDate>Wed, 11 Jan 2023 02:32:46 GMT</pubDate>
      
      
      
      
      <category domain="http://example.com/categories/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/">数字电路</category>
      
      
      
      <comments>http://example.com/2023/01/11/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/%E7%AC%AC%E4%B8%80%E7%AB%A0/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
